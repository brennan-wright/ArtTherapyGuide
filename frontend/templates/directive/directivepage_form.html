{% extends "base.html" %}
{% load static widget_tweaks %}

{% block meta_description %}

{% endblock %}

{% block head_title %}
Directive - Art Therapy Guide
{% endblock %}


{% block content %}

<div class="container my-3">
    <div class='media rounded-cards shadow p-4 my-4'>
        {% if page %}
        <h2 class="my-4">Edit: {{ page.title }}</h2>
        {% else %}
        <h2 class="my-4">Create New Directive</h2>
        {% endif %}
        <p>What you create here remains yours, forever. By submitting a directive to the Art Therapy Guide, we
            do not force you to give us ownership of your idea. Our goal is to provide a platform to share, not
            monitize your contributions. What you make is yours, we just want to help you share your great idea with
            others.
        </p>
        <h5>General</h5>
        <div class="col">
            <form action="" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form.management_form }}

                <div class="mb-3">
                    {{ form.title.label_tag }}

                    {% render_field form.title class="form-control" placeholder="" %}
                    {% if form.title.help_text %}
                    <small class="form-text text-muted">{{ form.title.help_text }}</small>
                    {% endif %}

                    {% if form.title.errors %}
                    {% for error in form.title.errors %}
                    <div class="invalid-feedback">{{ error|escape }}</div>
                    {% endfor %}
                    {% endif %}

                </div>
                <div class="mb-3">
                    {{ form.intro.label_tag }}
                    {% render_field form.intro class="form-control" placeholder="" %}
                    {% if form.intro.help_text %}
                    <small class="form-text text-muted">{{ form.intro.help_text }}</small>
                    {% endif %}
                </div>
                <div class="mb-3">
                    {{ form.population.label_tag }}
                    {% render_field form.population class="form-control" placeholder="" %}
                    {% if form.population.help_text %}
                    <small class="form-text text-muted">{{ form.population.help_text }}</small>
                    {% endif %}
                </div>
                <div class="mb-3">
                    {{ form.diagnosis.label_tag }}
                    {% render_field form.diagnosis class="form-control" placeholder="" %}
                    {% if form.diagnosis.help_text %}
                    <small class="form-text text-muted">{{ form.diagnosis.help_text }}</small>
                    {% endif %}
                </div>

                {% for hidden in form.hidden_fields %}
                {{ hidden.errors.as_ul }}
                {% render_field hidden class="form-control" placeholder="" %}
                {% endfor %}

                {{ form.non_field_errors }}

                <div>
                    <h5>Objectives</h5>
                    <div class="mb-3">
                        {{ objectiveformset.management_form }}
                        {{ objectiveformset.non_form_errors }}
                        {% for form in objectiveformset.forms %}

                        {% for field in form.visible_fields %}
                        {{ field.errors.as_ul }}
                        {% endfor %}
                        <div class="objective_formset_row input-group mb-3">

                            {% for field in form.visible_fields %}
                            {{ field.errors.as_ul }}
                            {% render_field field class="form-control" placeholder=""  %}
                            {% endfor %}
                            {% for hidden in form.hidden_fields %}
                            {{ hidden.errors.as_ul }}
                            {% render_field hidden class="form-control" placeholder="" %}
                            {% endfor %}

                        </div>
                        {% endfor %}
                    </div>

                </div>
                <div>
                    <h5>Materials</h5>
                    <div class="mb-3">
                        {{ materialformset.management_form }}
                        {{ materialformset.non_form_errors }}
                        {% for form in materialformset.forms %}

                        {% for field in form.visible_fields %}
                        {{ field.errors.as_ul }}
                        {% endfor %}
                        <div class="material_formset_row input-group mb-3">

                            {% for field in form.visible_fields %}
                            {{ field.errors.as_ul }}

                            {% render_field field class="form-control" placeholder="" %}
                            {% endfor %}

                            {% for hidden in form.hidden_fields %}
                            {{ hidden.errors.as_ul }}
                            {% render_field hidden class="form-control" placeholder="" %}
                            {% endfor %}

                        </div>
                        {% endfor %}
                    </div>

                </div>
                <div>
                    <h5>Instructions</h5>
                    <div class="mb-3">
                        {{ instructionformset.management_form }}
                        {{ instructionformset.non_form_errors }}

                        {% for form in instructionformset.forms %}
                        {% for field in form.visible_fields %}
                        {{ field.errors.as_ul }}
                        {% endfor %}
                        <div class="instruction_formset_row input-group mb-3">

                            {% for field in form.visible_fields %}

                            {% render_field field class="form-control" placeholder="" %}
                            {% endfor %}

                            {% for hidden in form.hidden_fields %}
                            {{ hidden.errors.as_ul }}
                            {% render_field hidden class="form-control" placeholder="" %}
                            {% endfor %}

                        </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="mb-3">
                    <h5>Discucssion</h5>
                    {% render_field form.discussion class="form-control" placeholder="" %}
                    {% if form.discussion.help_text %}
                    <small class="form-text text-muted">{{ form.discussion.help_text }}</small>
                    {% endif %}
                </div>
                <h5>Images</h5>
                <p>First image in the list will be the primary image.</p>
                <div class="mb-3">
                    {{ imageformset.management_form }}
                    {{ imageformset.non_form_errors }}
                    {% for form in imageformset.forms %}
                    {% for field in form.visible_fields %}
                    {{ field.errors.as_ul }}
                    {% endfor %}
                    <div class="image_formset_row input-group mb-3">

                        {% for field in form.visible_fields %}
                        {{ field.errors.as_ul }}

                        {% render_field field class="form-control" placeholder="" %}
                        {% endfor %}

                        {% for hidden in form.hidden_fields %}
                        {{ hidden.errors.as_ul }}
                        {% render_field hidden class="form-control" placeholder="" %}
                        {% endfor %}

                    </div>
                    {% endfor %}
                </div>
                <div>
                    <button type="submit" class="btn btn-success">
                        <i class="bi bi-check-lg"></i> Save
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="{% static 'formset/jquery.formset.js' %}"></script>
<script type="text/javascript">
    $(function () {
        $('.objective_formset_row').formset({
            prefix: '{{ objectiveformset.prefix}}',
            formCssClass: 'dynamic-objective-form',
            addCssClass: 'btn btn-primary',
            deleteCssClass: 'btn btn-danger objectivebtn',
            addText: '+', // Text for the add link
            deleteText: '-', // Text for the delete link
        });
        $('.material_formset_row').formset({
            prefix: '{{ materialformset.prefix}}',
            formCssClass: 'dynamic-material-form',
            addCssClass: 'btn btn-primary',
            deleteCssClass: 'btn btn-danger materialbtn',
            addText: '+', // Text for the add link
            deleteText: '-', // Text for the delete link
        });
        $('.instruction_formset_row').formset({
            prefix: '{{ instructionformset.prefix}}',
            formCssClass: 'dynamic-instruction-form',
            addCssClass: 'btn btn-primary',
            deleteCssClass: 'btn btn-danger instructionbtn',
            addText: '+', // Text for the add link
            deleteText: '-', // Text for the delete link

        });
        $('.image_formset_row').formset({
            prefix: '{{ imageformset.prefix}}',
            formCssClass: 'dynamic-image-form',
            addCssClass: 'btn btn-primary',
            deleteCssClass: 'btn btn-danger imagebtn',
            addText: '+', // Text for the add link,
            deleteText: '-', // Text for the delete link
        });
    });
</script>
{% endblock %}

{% block extra_script %}
{% endblock extra_script %}